import{j as e,g as j,r as N,L as p}from"./main-RiaZkz5G.js";import{c as l}from"./utils-CDN07tui.js";import{u as g}from"./use-assessment-ogEYb1AK.js";import"./useMutation-CSCeiqsJ.js";function v({archetypeName:t,oceanCode4:n,oceanCode5:d,description:o,color:i,isCurated:s,overallConfidence:r,className:a}){const m=Math.min(Math.max(r,0),100);return e.jsxs("article",{"aria-label":`Archetype: ${t}`,"data-testid":"archetype-card",className:l("relative overflow-hidden rounded-2xl border border-slate-700/50 bg-slate-800/80 p-6 md:p-8",a),children:[e.jsx("div",{className:l("absolute inset-x-0 top-0 h-1.5",s?"opacity-100":"opacity-60"),style:{backgroundColor:i},"data-testid":"archetype-accent"}),e.jsxs("div",{className:"mt-2 flex flex-col gap-4 md:flex-row md:items-start md:justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h2",{className:"text-2xl font-bold tracking-tight text-white md:text-3xl","data-testid":"archetype-name",children:t}),e.jsxs("div",{className:"mt-2 flex items-center gap-3",children:[e.jsx("span",{className:"rounded-md bg-slate-700/60 px-2.5 py-1 font-mono text-sm font-semibold text-slate-200","data-testid":"ocean-code-4",children:n}),e.jsx("span",{className:"font-mono text-xs text-slate-400","data-testid":"ocean-code-5",children:d})]})]}),e.jsxs("div",{className:"flex items-center gap-2 rounded-lg bg-slate-700/40 px-3 py-2","data-testid":"confidence-indicator",children:[e.jsx("div",{className:"h-8 w-8 rounded-full border-2 border-slate-600 flex items-center justify-center",children:e.jsx("span",{className:"text-xs font-bold text-slate-200",children:m})}),e.jsx("span",{className:"text-xs text-slate-400",children:"% confidence"})]})]}),e.jsx("p",{className:"mt-4 text-sm leading-relaxed text-slate-300 md:text-base","data-testid":"archetype-description",children:o}),s&&e.jsx("span",{className:"mt-4 inline-block rounded-full bg-slate-700/50 px-3 py-1 text-xs text-slate-400","data-testid":"curated-badge",children:"Curated archetype"})]})}const u=20,w=15,y=30;function C({traitName:t,facets:n,traitScore:d,id:o,className:i}){return e.jsxs("section",{id:o,"aria-label":`${t} facet breakdown`,"data-testid":`facet-breakdown-${t}`,className:l("overflow-hidden rounded-b-xl border border-t-0 border-slate-700/50 bg-slate-850/40 transition-all duration-300",i),children:[e.jsx("div",{className:"border-b border-slate-700/30 px-4 py-3",children:e.jsxs("p",{className:"text-xs text-slate-400","data-testid":"facet-sum-label",children:["6 facets sum to"," ",e.jsx("span",{className:"font-medium text-slate-300",children:t.charAt(0).toUpperCase()+t.slice(1)})," ","trait score (",d,"/120)"]})}),e.jsx("ul",{className:"divide-y divide-slate-700/20 px-4","data-testid":"facet-list",children:n.map(s=>{const r=s.score>=w,a=s.confidence<y,m=Math.round(Math.min(Math.max(s.score,0),u)/u*100);return e.jsxs("li",{"aria-label":`${s.name}: ${s.score} out of ${u}, ${s.confidence}% confidence`,"data-testid":`facet-item-${s.name}`,className:l("py-3",a&&"opacity-60"),children:[e.jsxs("div",{className:"flex items-center justify-between gap-2",children:[e.jsxs("div",{className:"flex items-center gap-2 min-w-0",children:[e.jsx("span",{className:l("text-sm truncate",r?"font-semibold text-white":"text-slate-300"),children:s.name}),r&&e.jsx("span",{className:"shrink-0 text-xs text-amber-400","aria-hidden":"true","data-testid":`facet-highlight-${s.name}`,children:"â˜…"})]}),e.jsxs("div",{className:"flex items-center gap-3 shrink-0",children:[e.jsxs("span",{className:"text-xs font-medium text-slate-300",children:[s.score,"/",u]}),e.jsxs("span",{className:l("text-xs",a?"text-red-400":"text-slate-500"),"data-testid":`facet-confidence-${s.name}`,children:[s.confidence,"%"]})]})]}),e.jsx("div",{className:"mt-1.5",children:e.jsx("div",{className:l("h-1.5 w-full overflow-hidden rounded-full bg-slate-700/40",a&&"border border-dashed border-slate-600/40"),children:e.jsx("div",{className:l("h-full rounded-full transition-all duration-300",r?"bg-amber-400/80":"bg-slate-500/60"),style:{width:`${m}%`},"data-testid":`facet-fill-${s.name}`})})}),e.jsx("button",{type:"button",disabled:!0,className:"mt-1.5 text-xs text-slate-500 cursor-not-allowed","data-testid":`facet-evidence-btn-${s.name}`,children:"View Evidence"})]},s.name)})})]})}const k={H:"High",M:"Mid",L:"Low"},b=120;function E({traitName:t,score:n,level:d,confidence:o,color:i,isExpanded:s,onToggle:r,controlsId:a,className:m}){const x=Math.min(Math.max(n,0),b),h=Math.round(x/b*100),c=Math.min(Math.max(o,0),100),f=t.charAt(0).toUpperCase()+t.slice(1);return e.jsxs("button",{type:"button","aria-expanded":s,"aria-controls":a,onClick:r,"data-testid":`trait-bar-${t}`,className:l("w-full rounded-xl border border-slate-700/50 bg-slate-800/60 p-4 text-left transition-colors hover:bg-slate-800/80",s&&"border-slate-600/60",m),children:[e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsxs("div",{className:"flex items-center gap-3 min-w-0",children:[e.jsx("div",{className:"h-3 w-3 shrink-0 rounded-full",style:{backgroundColor:i},"data-testid":`trait-color-${t}`}),e.jsx("span",{className:"text-sm font-semibold text-white truncate",children:f}),e.jsx("span",{className:l("shrink-0 rounded-md px-2 py-0.5 text-xs font-medium",d==="H"&&"bg-emerald-900/40 text-emerald-300",d==="M"&&"bg-amber-900/40 text-amber-300",d==="L"&&"bg-slate-700/60 text-slate-300"),"data-testid":`trait-level-${t}`,children:k[d]})]}),e.jsxs("div",{className:"flex items-center gap-3 shrink-0",children:[e.jsxs("span",{className:"text-xs text-slate-400","data-testid":`trait-confidence-${t}`,children:[c,"%"]}),e.jsx("svg",{className:l("h-4 w-4 text-slate-400 transition-transform duration-200",s&&"rotate-180"),fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,"aria-hidden":"true",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19 9l-7 7-7-7"})})]})]}),e.jsxs("div",{className:"mt-3",children:[e.jsx("div",{className:"flex items-center justify-between mb-1",children:e.jsxs("span",{className:"text-xs text-slate-500",children:[x," / ",b]})}),e.jsx("div",{className:"h-2 w-full overflow-hidden rounded-full bg-slate-700/60","data-testid":`trait-track-${t}`,children:e.jsx("div",{className:"h-full rounded-full transition-all duration-500 ease-out",style:{width:`${h}%`,backgroundColor:i,opacity:c<30?.5:1},"data-testid":`trait-fill-${t}`})})]})]})}const $={openness:"#6B5CE7",conscientiousness:"#E87B35",extraversion:"#E74C8B",agreeableness:"#4CAF6E",neuroticism:"#2C3E7B"},L=50;function H(){const{sessionId:t}=j.useParams(),{data:n,isLoading:d,error:o}=g(t),[i,s]=N.useState(null);if(d)return e.jsx(M,{});if(o)return e.jsx("div",{className:"flex min-h-[60vh] items-center justify-center px-4",children:e.jsxs("div",{className:"text-center",children:[e.jsx("h2",{className:"text-xl font-semibold text-white",children:"Session not found"}),e.jsx("p",{className:"mt-2 text-sm text-slate-400",children:"This assessment session could not be found or has expired."}),e.jsx(p,{to:"/",className:"mt-6 inline-block rounded-lg bg-slate-700 px-6 py-2.5 text-sm font-medium text-white hover:bg-slate-600 transition-colors",children:"Back to Home"})]})});if(!n)return null;const r=n.overallConfidence<L;return e.jsxs("div",{className:"mx-auto max-w-2xl px-4 py-8","data-testid":"results-page",children:[r&&e.jsxs("div",{className:"mb-6 rounded-xl border border-amber-700/30 bg-amber-900/20 p-4","data-testid":"low-confidence-banner",children:[e.jsx("p",{className:"text-sm font-medium text-amber-200",children:"Keep talking to see more accurate results"}),e.jsx("p",{className:"mt-1 text-xs text-amber-300/70",children:"Some facets have low confidence. Continue your assessment for better accuracy."}),e.jsx(p,{to:"/chat",search:{sessionId:t},className:"mt-3 inline-block rounded-lg bg-amber-700/30 px-4 py-2 text-sm font-medium text-amber-200 hover:bg-amber-700/50 transition-colors","data-testid":"continue-assessment-btn",children:"Continue Assessment"})]}),e.jsx(v,{archetypeName:n.archetypeName,oceanCode4:n.oceanCode4,oceanCode5:n.oceanCode5,description:n.archetypeDescription,color:n.archetypeColor,isCurated:n.isCurated,overallConfidence:n.overallConfidence}),e.jsxs("div",{className:"mt-8 space-y-2","data-testid":"trait-summary",children:[e.jsx("h3",{className:"mb-4 text-lg font-semibold text-white",children:"Your Traits"}),n.traits.map(a=>{const m=n.facets.filter(c=>c.traitName===a.name).map(c=>({name:c.name,score:c.score,confidence:c.confidence})),x=i===a.name,h=`facets-${a.name}`;return e.jsxs("div",{children:[e.jsx(E,{traitName:a.name,score:a.score,level:a.level,confidence:a.confidence,color:$[a.name]??"#6B7280",isExpanded:x,onToggle:()=>s(x?null:a.name),controlsId:h}),x&&e.jsx(C,{traitName:a.name,facets:m,traitScore:a.score,id:h})]},a.name)})]}),e.jsxs("div",{className:"mt-8 flex flex-col gap-3 sm:flex-row sm:justify-center",children:[r&&e.jsx(p,{to:"/chat",search:{sessionId:t},className:"rounded-lg bg-slate-700 px-6 py-2.5 text-center text-sm font-medium text-white hover:bg-slate-600 transition-colors",children:"Continue Assessment"}),e.jsx("button",{type:"button",disabled:!0,className:"rounded-lg bg-slate-800 px-6 py-2.5 text-sm font-medium text-slate-500 cursor-not-allowed","data-testid":"share-archetype-btn",children:"Share My Archetype"})]})]})}function M(){return e.jsxs("div",{className:"mx-auto max-w-2xl px-4 py-8","data-testid":"results-skeleton",children:[e.jsxs("div",{className:"animate-pulse rounded-2xl border border-slate-700/50 bg-slate-800/80 p-6 md:p-8",children:[e.jsx("div",{className:"h-1.5 w-full rounded bg-slate-700"}),e.jsx("div",{className:"mt-6 h-8 w-3/4 rounded bg-slate-700"}),e.jsxs("div",{className:"mt-3 flex gap-3",children:[e.jsx("div",{className:"h-7 w-16 rounded bg-slate-700"}),e.jsx("div",{className:"h-7 w-20 rounded bg-slate-700"})]}),e.jsxs("div",{className:"mt-4 space-y-2",children:[e.jsx("div",{className:"h-4 w-full rounded bg-slate-700"}),e.jsx("div",{className:"h-4 w-5/6 rounded bg-slate-700"})]})]}),e.jsxs("div",{className:"mt-8 space-y-2",children:[e.jsx("div",{className:"h-6 w-32 rounded bg-slate-700"}),["skel-o","skel-c","skel-e","skel-a","skel-n"].map(t=>e.jsxs("div",{className:"animate-pulse rounded-xl border border-slate-700/50 bg-slate-800/60 p-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"h-3 w-3 rounded-full bg-slate-700"}),e.jsx("div",{className:"h-4 w-28 rounded bg-slate-700"}),e.jsx("div",{className:"h-5 w-12 rounded bg-slate-700"})]}),e.jsx("div",{className:"mt-3 h-2 w-full rounded-full bg-slate-700"})]},t))]})]})}export{H as component};
